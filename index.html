<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSON Encode/Decode trong PHP - Hướng Dẫn Chi Tiết</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                url("data:image/svg+xml,%3Csvg width='180' height='180' xmlns='http://www.w3.org/2000/svg'%3E%3Cg opacity='0.4'%3E%3Cpath d='M40 120 Q35 100 40 90 Q45 80 50 85 Q55 90 60 85 Q65 80 70 85 Q75 90 80 85 Q85 80 90 85 Q95 90 100 85 Q105 80 110 85 Q115 90 120 85 Q125 80 130 85 L130 120 Z' fill='%23ffb6c1'/%3E%3Ccircle cx='50' cy='95' r='7' fill='%23ffffff'/%3E%3Ccircle cx='70' cy='95' r='7' fill='%23ffffff'/%3E%3Cpath d='M55 105 Q60 110 65 105' stroke='%23ffffff' stroke-width='2' fill='none'/%3E%3Cpath d='M45 90 Q40 75 45 65 Q50 55 55 60 Q60 65 65 60 Q70 55 75 60 Q80 65 85 60 Q90 55 95 60 Q100 65 105 60 Q110 55 115 60 L115 90 Z' fill='%23ffd700'/%3E%3Ccircle cx='55' cy='70' r='5' fill='%23ffffff'/%3E%3Ccircle cx='75' cy='70' r='5' fill='%23ffffff'/%3E%3Cpath d='M60 80 Q65 85 70 80' stroke='%23ffffff' stroke-width='2' fill='none'/%3E%3Cpath d='M50 65 L45 50 L40 55 L35 50 L30 55' stroke='%23ffffff' stroke-width='2' fill='none'/%3E%3Cpath d='M90 65 L95 50 L100 55 L105 50 L110 55' stroke='%23ffffff' stroke-width='2' fill='none'/%3E%3C/g%3E%3C/svg%3E");
            background-size: 250px 250px;
            background-position: 10% 15%, 85% 75%;
            background-repeat: no-repeat;
            pointer-events: none;
            z-index: 0;
        }

        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                url("data:image/svg+xml,%3Csvg width='160' height='160' xmlns='http://www.w3.org/2000/svg'%3E%3Cg opacity='0.35'%3E%3Cpath d='M30 110 Q25 90 30 80 Q35 70 40 75 Q45 80 50 75 Q55 70 60 75 Q65 80 70 75 Q75 70 80 75 Q85 80 90 75 Q95 70 100 75 Q105 80 110 75 Q115 70 120 75 L120 110 Z' fill='%23ffb6c1'/%3E%3Ccircle cx='40' cy='85' r='6' fill='%23ffffff'/%3E%3Ccircle cx='60' cy='85' r='6' fill='%23ffffff'/%3E%3Cpath d='M45 95 Q50 100 55 95' stroke='%23ffffff' stroke-width='2' fill='none'/%3E%3Cpath d='M35 80 Q30 65 35 55 Q40 45 45 50 Q50 55 55 50 Q60 45 65 50 Q70 55 75 50 Q80 45 85 50 Q90 55 95 50 Q100 45 105 50 L105 80 Z' fill='%23ffd700'/%3E%3Ccircle cx='45' cy='60' r='4' fill='%23ffffff'/%3E%3Ccircle cx='65' cy='60' r='4' fill='%23ffffff'/%3E%3Cpath d='M50 70 Q55 75 60 70' stroke='%23ffffff' stroke-width='2' fill='none'/%3E%3Cpath d='M40 55 L35 40 L30 45 L25 40 L20 45' stroke='%23ffffff' stroke-width='2' fill='none'/%3E%3Cpath d='M80 55 L85 40 L90 45 L95 40 L100 45' stroke='%23ffffff' stroke-width='2' fill='none'/%3E%3C/g%3E%3C/svg%3E");
            background-size: 220px 220px;
            background-position: 88% 20%, 12% 82%;
            background-repeat: no-repeat;
            pointer-events: none;
            z-index: 0;
        }

        .container {
            position: relative;
            z-index: 1;
        }

        .container {
            max-width: 900px;
            margin-left: auto;
            margin-right: 320px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .content {
            padding: 40px;
        }

        .main-content {
            min-width: 0;
        }

        .section {
            margin-bottom: 50px;
            animation: fadeIn 0.6s ease-in;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .section-title {
            font-size: 2em;
            color: #667eea;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
            display: flex;
            align-items: center;
            gap: 10px;
        }


        .subsection {
            margin: 30px 0;
            padding: 25px;
            background: #f5f5f5;
            border-radius: 10px;
        }

        .subsection h3 {
            color: #764ba2;
            margin-bottom: 15px;
            font-size: 1.5em;
        }

        .code-block {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 8px;
            overflow-x: visible;
            overflow-wrap: break-word;
            word-wrap: break-word;
            white-space: pre-wrap;
            margin: 15px 0;
            position: relative;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
        }

        .code-block::before {
            content: "PHP";
            position: absolute;
            top: 10px;
            right: 15px;
            color: #888;
            font-size: 12px;
        }

        .code-block .keyword {
            color: #f92672;
        }

        .code-block .string {
            color: #e6db74;
        }

        .code-block .function {
            color: #66d9ef;
        }

        .code-block .comment {
            color: #75715e;
        }

        .output {
            background: #f0f0f0;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            overflow-wrap: break-word;
            word-wrap: break-word;
            white-space: pre-wrap;
        }

        .output::before {
            content: "Kết quả: ";
            font-weight: bold;
            color: #666;
        }

        .info-box {
            background: #f0f0f0;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }

        .warning-box {
            background: #f0f0f0;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }

        .success-box {
            background: #f0f0f0;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }

        .example-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .example-card {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 20px;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .example-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            border-color: #667eea;
        }

        .example-card h4 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .btn {
            display: inline-block;
            padding: 12px 24px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-decoration: none;
            border-radius: 25px;
            margin: 10px 5px;
            transition: transform 0.3s, box-shadow 0.3s;
            border: none;
            cursor: pointer;
            font-size: 16px;
        }

        .btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .interactive-demo {
            background: #f5f5f5;
            padding: 25px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .demo-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            margin: 10px 0;
        }

        .demo-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .toc {
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
            padding: 25px;
            border-radius: 15px;
            position: fixed;
            top: 20px;
            right: 20px;
            width: 280px;
            z-index: 1000;
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
            max-height: calc(100vh - 40px);
            overflow-y: auto;
            border: 1px solid #e0e0e0;
        }

        .toc h3 {
            display: none;
        }

        .toc ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .toc li {
            padding: 12px 0;
            border-bottom: 1px solid #e8e8e8;
            transition: background-color 0.3s;
        }

        .toc li:last-child {
            border-bottom: none;
        }

        .toc li:hover {
            background-color: rgba(102, 126, 234, 0.05);
            padding-left: 8px;
            border-radius: 5px;
        }

        .toc a {
            color: #555;
            text-decoration: none;
            transition: all 0.3s;
            display: block;
            font-size: 0.9em;
            line-height: 1.5;
            font-weight: 500;
        }

        .toc a:hover {
            color: #667eea;
            font-weight: 600;
        }

        .highlight {
            background: #fff9c4;
            padding: 2px 6px;
            border-radius: 3px;
        }

        @media (max-width: 1300px) {
            .container {
                max-width: calc(100% - 340px);
                margin-left: 20px;
                margin-right: 20px;
            }
            
            .toc {
                right: 20px;
            }
        }

        @media (max-width: 1024px) {
            .container {
                margin-left: 20px;
                margin-right: 20px;
            }
            
            .toc {
                position: relative;
                top: 0;
                right: 0;
                width: 100%;
                max-height: none;
                margin-bottom: 30px;
            }
        }

        @media (max-width: 768px) {
            .content {
                padding: 20px;
            }
            
            .example-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="content">
            <div class="main-content">
            <section id="intro" class="section">
                <h2 class="section-title">1. Giới thiệu</h2>
                <div class="info-box">
                    <strong>JSON (JavaScript Object Notation)</strong> là định dạng dữ liệu phổ biến để trao đổi thông tin giữa server và client. 
                    PHP cung cấp 2 hàm chính để làm việc với JSON:
                    <ul style="margin-top: 10px; margin-left: 20px;">
                        <li><code>json_encode()</code> - Chuyển đổi dữ liệu PHP sang chuỗi JSON</li>
                        <li><code>json_decode()</code> - Chuyển đổi chuỗi JSON về dữ liệu PHP</li>
                    </ul>
                </div>
            </section>

            <section id="json-encode" class="section">
                <h2 class="section-title">2. json_encode() - Chuyển đổi sang JSON</h2>
                
                <div class="subsection">
                    <h3>Cú pháp cơ bản</h3>
                    <div class="code-block">
<span class="keyword">$json</span> = <span class="function">json_encode</span>(<span class="keyword">$data</span>);
                    </div>
                </div>

                <div class="subsection">
                    <h3>Ví dụ 1: Encode mảng đơn giản</h3>
                    <div class="code-block">
<span class="comment">// Mảng PHP</span>
<span class="keyword">$array</span> = [
    <span class="string">'name'</span> => <span class="string">'Nguyễn Văn A'</span>,
    <span class="string">'age'</span> => <span class="string">25</span>,
    <span class="string">'city'</span> => <span class="string">'Hà Nội'</span>
];

<span class="comment">// Chuyển sang JSON</span>
<span class="keyword">$json</span> = <span class="function">json_encode</span>(<span class="keyword">$array</span>);
<span class="function">echo</span> <span class="keyword">$json</span>;
                    </div>
                    <div class="output">
{"name":"Nguyễn Văn A","age":25,"city":"Hà Nội"}
                    </div>
                </div>

                <div class="subsection">
                    <h3>Ví dụ 2: Encode mảng đa chiều</h3>
                    <div class="code-block">
<span class="keyword">$students</span> = [
    [
        <span class="string">'id'</span> => <span class="string">1</span>,
        <span class="string">'name'</span> => <span class="string">'Nguyễn Văn A'</span>,
        <span class="string">'score'</span> => <span class="string">8.5</span>
    ],
    [
        <span class="string">'id'</span> => <span class="string">2</span>,
        <span class="string">'name'</span> => <span class="string">'Trần Thị B'</span>,
        <span class="string">'score'</span> => <span class="string">9.0</span>
    ]
];

<span class="keyword">$json</span> = <span class="function">json_encode</span>(<span class="keyword">$students</span>);
<span class="function">echo</span> <span class="keyword">$json</span>;
                    </div>
                    <div class="output">
[{"id":1,"name":"Nguy\u1ec5n V\u0103n A","score":8.5},{"id":2,"name":"Tr\u1ea7n Th\u1ecb B","score":9.0}]
                    </div>
                </div>

                <div class="subsection">
                    <h3>Ví dụ 3: Encode object</h3>
                    <div class="code-block">
<span class="keyword">class</span> <span class="function">User</span> {
    <span class="keyword">public</span> <span class="keyword">$name</span>;
    <span class="keyword">public</span> <span class="keyword">$email</span>;
    
    <span class="keyword">public function</span> <span class="function">__construct</span>(<span class="keyword">$name</span>, <span class="keyword">$email</span>) {
        <span class="keyword">$this</span>-><span class="keyword">name</span> = <span class="keyword">$name</span>;
        <span class="keyword">$this</span>-><span class="keyword">email</span> = <span class="keyword">$email</span>;
    }
}

<span class="keyword">$user</span> = <span class="keyword">new</span> <span class="function">User</span>(<span class="string">'Nguyễn Văn A'</span>, <span class="string">'nguyenvana@example.com'</span>);
<span class="keyword">$json</span> = <span class="function">json_encode</span>(<span class="keyword">$user</span>);
<span class="function">echo</span> <span class="keyword">$json</span>;
                    </div>
                    <div class="output">
{"name":"Nguyễn Văn A","email":"nguyenvana@example.com"}
                    </div>
                </div>
            </section>

            <section id="json-decode" class="section">
                <h2 class="section-title">3. json_decode() - Chuyển đổi từ JSON</h2>
                
                <div class="subsection">
                    <h3>Cú pháp cơ bản</h3>
                    <div class="code-block">
<span class="keyword">$data</span> = <span class="function">json_decode</span>(<span class="keyword">$json_string</span>, <span class="keyword">true</span>); <span class="comment">// true = trả về mảng, false = trả về object</span>
                    </div>
                </div>

                <div class="subsection">
                    <h3>Ví dụ 1: Decode thành mảng</h3>
                    <div class="code-block">
<span class="keyword">$json</span> = <span class="string">'{"name":"Nguyễn Văn A","age":25,"city":"Hà Nội"}'</span>;

<span class="comment">// Decode thành mảng</span>
<span class="keyword">$array</span> = <span class="function">json_decode</span>(<span class="keyword">$json</span>, <span class="keyword">true</span>);

<span class="function">print_r</span>(<span class="keyword">$array</span>);
<span class="function">echo</span> <span class="string">"\nTên: "</span> . <span class="keyword">$array</span>[<span class="string">'name'</span>];
                    </div>
                    <div class="output">
Array
(
    [name] => Nguyễn Văn A
    [age] => 25
    [city] => Hà Nội
)
Tên: Nguyễn Văn A
                    </div>
                </div>

                <div class="subsection">
                    <h3>Ví dụ 2: Decode thành object</h3>
                    <div class="code-block">
<span class="keyword">$json</span> = <span class="string">'{"name":"Nguyễn Văn A","age":25,"city":"Hà Nội"}'</span>;

<span class="comment">// Decode thành object (mặc định)</span>
<span class="keyword">$obj</span> = <span class="function">json_decode</span>(<span class="keyword">$json</span>);

<span class="function">echo</span> <span class="string">"Tên: "</span> . <span class="keyword">$obj</span>-><span class="keyword">name</span> . <span class="string">"\n"</span>;
<span class="function">echo</span> <span class="string">"Tuổi: "</span> . <span class="keyword">$obj</span>-><span class="keyword">age</span> . <span class="string">"\n"</span>;
<span class="function">echo</span> <span class="string">"Thành phố: "</span> . <span class="keyword">$obj</span>-><span class="keyword">city</span>;
                    </div>
                    <div class="output">
Tên: Nguyễn Văn A
Tuổi: 25
Thành phố: Hà Nội
                    </div>
                </div>

                <div class="subsection">
                    <h3>Ví dụ 3: Xử lý lỗi khi decode</h3>
                    <div class="code-block">
<span class="keyword">$json</span> = <span class="string">'{"name":"Nguyễn Văn A","age":25}'</span>; <span class="comment">// JSON hợp lệ</span>
<span class="keyword">$invalidJson</span> = <span class="string">'{name:"Nguyễn Văn A"}'</span>; <span class="comment">// JSON không hợp lệ</span>

<span class="comment">// Kiểm tra JSON hợp lệ</span>
<span class="keyword">$data</span> = <span class="function">json_decode</span>(<span class="keyword">$json</span>, <span class="keyword">true</span>);

<span class="keyword">if</span> (<span class="function">json_last_error</span>() === <span class="function">JSON_ERROR_NONE</span>) {
    <span class="function">echo</span> <span class="string">"JSON hợp lệ!\n"</span>;
    <span class="function">print_r</span>(<span class="keyword">$data</span>);
} <span class="keyword">else</span> {
    <span class="function">echo</span> <span class="string">"Lỗi JSON: "</span> . <span class="function">json_last_error_msg</span>();
}

<span class="comment">// Kiểm tra JSON không hợp lệ</span>
<span class="keyword">$data2</span> = <span class="function">json_decode</span>(<span class="keyword">$invalidJson</span>, <span class="keyword">true</span>);
<span class="keyword">if</span> (<span class="function">json_last_error</span>() !== <span class="function">JSON_ERROR_NONE</span>) {
    <span class="function">echo</span> <span class="string">"\nLỗi: "</span> . <span class="function">json_last_error_msg</span>();
}
                    </div>
                    <div class="output">
JSON hợp lệ!
Array
(
    [name] => Nguyễn Văn A
    [age] => 25
)
Lỗi: Syntax error
                    </div>
                    <div class="warning-box">
                        <strong>Luôn kiểm tra lỗi:</strong> Luôn sử dụng <code>json_last_error()</code> để kiểm tra xem JSON có hợp lệ không trước khi sử dụng dữ liệu.
                    </div>
                </div>
            </section>

            <section id="json-cookie" class="section">
                <h2 class="section-title">4. JSON với Cookie - Ứng dụng thực tế</h2>
                
                <div class="info-box">
                    Cookie chỉ lưu được <span class="highlight">chuỗi text</span>, không thể lưu trực tiếp mảng hay object. 
                    Vì vậy, chúng ta cần <strong>encode mảng/object thành JSON</strong> trước khi lưu vào cookie, 
                    và <strong>decode lại</strong> khi đọc từ cookie.
                </div>

                <div class="subsection">
                    <h3>Ví dụ 1: Lưu dữ liệu vào Cookie</h3>
                    <div class="code-block">
<span class="comment">// Dữ liệu cần lưu</span>
<span class="keyword">$userData</span> = [
    <span class="string">'username'</span> => <span class="string">'nguyenvana'</span>,
    <span class="string">'email'</span> => <span class="string">'nguyenvana@example.com'</span>,
    <span class="string">'preferences'</span> => [
        <span class="string">'theme'</span> => <span class="string">'dark'</span>,
        <span class="string">'language'</span> => <span class="string">'vi'</span>
    ]
];

<span class="comment">// Chuyển mảng thành JSON</span>
<span class="keyword">$jsonData</span> = <span class="function">json_encode</span>(<span class="keyword">$userData</span>);

<span class="comment">// Lưu vào cookie (hết hạn sau 7 ngày)</span>
<span class="function">setcookie</span>(
    <span class="string">'user_data'</span>,           <span class="comment">// Tên cookie</span>
    <span class="keyword">$jsonData</span>,              <span class="comment">// Giá trị (chuỗi JSON)</span>
    <span class="function">time</span>() + (<span class="string">7 * 24 * 60 * 60</span>),  <span class="comment">// Thời gian hết hạn</span>
    <span class="string">'/'</span>,                    <span class="comment">// Path</span>
    <span class="string">''</span>,                     <span class="comment">// Domain</span>
    <span class="keyword">true</span>,                   <span class="comment">// Secure (HTTPS only)</span>
    <span class="keyword">true</span>                    <span class="comment">// HttpOnly</span>
);

<span class="function">echo</span> <span class="string">"Đã lưu dữ liệu vào cookie!"</span>;
                    </div>
                </div>

                <div class="subsection">
                    <h3>Ví dụ 2: Đọc dữ liệu từ Cookie</h3>
                    <div class="code-block">
<span class="comment">// Kiểm tra cookie có tồn tại không</span>
<span class="keyword">if</span> (<span class="function">isset</span>(<span class="variable">$_COOKIE</span>[<span class="string">'user_data'</span>])) {
    <span class="comment">// Lấy giá trị cookie (chuỗi JSON)</span>
    <span class="keyword">$jsonData</span> = <span class="variable">$_COOKIE</span>[<span class="string">'user_data'</span>];
    
    <span class="comment">// Decode JSON thành mảng</span>
    <span class="keyword">$userData</span> = <span class="function">json_decode</span>(<span class="keyword">$jsonData</span>, <span class="keyword">true</span>);
    
    <span class="comment">// Kiểm tra decode có thành công không</span>
    <span class="keyword">if</span> (<span class="function">json_last_error</span>() === <span class="function">JSON_ERROR_NONE</span> && <span class="function">is_array</span>(<span class="keyword">$userData</span>)) {
        <span class="function">echo</span> <span class="string">"Username: "</span> . <span class="keyword">$userData</span>[<span class="string">'username'</span>] . <span class="string">"\n"</span>;
        <span class="function">echo</span> <span class="string">"Email: "</span> . <span class="keyword">$userData</span>[<span class="string">'email'</span>] . <span class="string">"\n"</span>;
        <span class="function">echo</span> <span class="string">"Theme: "</span> . <span class="keyword">$userData</span>[<span class="string">'preferences'</span>][<span class="string">'theme'</span>] . <span class="string">"\n"</span>;
    } <span class="keyword">else</span> {
        <span class="function">echo</span> <span class="string">"Lỗi khi decode JSON từ cookie!"</span>;
    }
} <span class="keyword">else</span> {
    <span class="function">echo</span> <span class="string">"Cookie không tồn tại!"</span>;
}
                    </div>
                    <div class="output">
Username: nguyenvana
Email: nguyenvana@example.com
Theme: dark
                    </div>
                </div>

                <div class="subsection">
                    <h3>Ví dụ 3: Cập nhật dữ liệu trong Cookie</h3>
                    <div class="code-block">
<span class="comment">// Đọc dữ liệu hiện tại từ cookie</span>
<span class="keyword">if</span> (<span class="function">isset</span>(<span class="variable">$_COOKIE</span>[<span class="string">'user_data'</span>])) {
    <span class="keyword">$userData</span> = <span class="function">json_decode</span>(<span class="variable">$_COOKIE</span>[<span class="string">'user_data'</span>], <span class="keyword">true</span>);
    
    <span class="comment">// Cập nhật dữ liệu</span>
    <span class="keyword">$userData</span>[<span class="string">'preferences'</span>][<span class="string">'theme'</span>] = <span class="string">'light'</span>; <span class="comment">// Đổi theme</span>
    <span class="keyword">$userData</span>[<span class="string">'last_visit'</span>] = <span class="function">date</span>(<span class="string">'Y-m-d H:i:s'</span>); <span class="comment">// Thêm thời gian truy cập</span>
    
    <span class="comment">// Encode lại và lưu vào cookie</span>
    <span class="keyword">$jsonData</span> = <span class="function">json_encode</span>(<span class="keyword">$userData</span>);
    <span class="function">setcookie</span>(<span class="string">'user_data'</span>, <span class="keyword">$jsonData</span>, <span class="function">time</span>() + (<span class="string">7 * 24 * 60 * 60</span>), <span class="string">'/'</span>);
    
    <span class="function">echo</span> <span class="string">"Đã cập nhật cookie!"</span>;
}
                    </div>
                </div>

                <div class="subsection">
                    <h3>Ví dụ 4: Lưu giỏ hàng vào Cookie</h3>
                    <div class="code-block">
<span class="comment">// Giỏ hàng của người dùng</span>
<span class="keyword">$cart</span> = [
    [
        <span class="string">'product_id'</span> => <span class="string">101</span>,
        <span class="string">'product_name'</span> => <span class="string">'Laptop Dell'</span>,
        <span class="string">'quantity'</span> => <span class="string">1</span>,
        <span class="string">'price'</span> => <span class="string">15000000</span>
    ],
    [
        <span class="string">'product_id'</span> => <span class="string">202</span>,
        <span class="string">'product_name'</span> => <span class="string">'Chuột không dây'</span>,
        <span class="string">'quantity'</span> => <span class="string">2</span>,
        <span class="string">'price'</span> => <span class="string">500000</span>
    ]
];

<span class="comment">// Lưu giỏ hàng vào cookie</span>
<span class="keyword">$cartJson</span> = <span class="function">json_encode</span>(<span class="keyword">$cart</span>);
<span class="function">setcookie</span>(<span class="string">'shopping_cart'</span>, <span class="keyword">$cartJson</span>, <span class="function">time</span>() + (<span class="string">30 * 24 * 60 * 60</span>), <span class="string">'/'</span>);

<span class="function">echo</span> <span class="string">"Đã lưu giỏ hàng!"</span>;

<span class="comment">// Đọc giỏ hàng từ cookie</span>
<span class="keyword">if</span> (<span class="function">isset</span>(<span class="variable">$_COOKIE</span>[<span class="string">'shopping_cart'</span>])) {
    <span class="keyword">$savedCart</span> = <span class="function">json_decode</span>(<span class="variable">$_COOKIE</span>[<span class="string">'shopping_cart'</span>], <span class="keyword">true</span>);
    
    <span class="function">echo</span> <span class="string">"\n\nGiỏ hàng của bạn:\n"</span>;
    <span class="keyword">$total</span> = <span class="string">0</span>;
    <span class="keyword">foreach</span> (<span class="keyword">$savedCart</span> <span class="keyword">as</span> <span class="keyword">$item</span>) {
        <span class="function">echo</span> <span class="string">"- "</span> . <span class="keyword">$item</span>[<span class="string">'product_name'</span>] . 
             <span class="string">" x"</span> . <span class="keyword">$item</span>[<span class="string">'quantity'</span>] . 
             <span class="string">" = "</span> . <span class="function">number_format</span>(<span class="keyword">$item</span>[<span class="string">'price'</span>] * <span class="keyword">$item</span>[<span class="string">'quantity'</span>]) . <span class="string">" VNĐ\n"</span>;
        <span class="keyword">$total</span> += <span class="keyword">$item</span>[<span class="string">'price'</span>] * <span class="keyword">$item</span>[<span class="string">'quantity'</span>];
    }
    <span class="function">echo</span> <span class="string">"\nTổng tiền: "</span> . <span class="function">number_format</span>(<span class="keyword">$total</span>) . <span class="string">" VNĐ"</span>;
}
                    </div>
                    <div class="output">
Đã lưu giỏ hàng!

Giỏ hàng của bạn:
- Laptop Dell x1 = 15,000,000 VNĐ
- Chuột không dây x2 = 1,000,000 VNĐ

Tổng tiền: 16,000,000 VNĐ
                    </div>
                </div>

                <div class="warning-box">
                    <strong>Lưu ý quan trọng:</strong>
                    <ul style="margin-top: 10px; margin-left: 20px;">
                        <li>Cookie có giới hạn kích thước (thường là 4KB), không nên lưu quá nhiều dữ liệu</li>
                        <li>Cookie có thể bị người dùng xóa hoặc tắt, nên có phương án dự phòng</li>
                        <li>Dữ liệu nhạy cảm không nên lưu trong cookie (nên dùng session hoặc database)</li>
                        <li>Luôn kiểm tra <code>json_last_error()</code> sau khi decode để đảm bảo dữ liệu hợp lệ</li>
                    </ul>
                </div>
            </section>

            </div>
        </div>
    </div>

    <div class="toc">
        <ul>
            <li><a href="#intro">1. Giới thiệu</a></li>
            <li><a href="#json-encode">2. json_encode() - Chuyển đổi sang JSON</a></li>
            <li><a href="#json-decode">3. json_decode() - Chuyển đổi từ JSON</a></li>
            <li><a href="#json-cookie">4. JSON với Cookie</a></li>
        </ul>
    </div>

    <script>
        // Smooth scroll cho các link trong mục lục
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Highlight code blocks on hover
        document.querySelectorAll('.code-block').forEach(block => {
            block.addEventListener('mouseenter', function() {
                this.style.transform = 'scale(1.01)';
                this.style.transition = 'transform 0.3s';
            });
            block.addEventListener('mouseleave', function() {
                this.style.transform = 'scale(1)';
            });
        });
    </script>
</body>
</html>
